#!/usr/bin/env bash
# bin/compile <build-dir> <cache-dir>

set -x
set -e
set -o pipefail

BUILD_DIR=$1
CACHE_DIR=$2
export UBUNTU_URL=http://us.archive.ubuntu.com/ubuntu

echo "DEB_PACKAGES: '$DEB_PACKAGES'"

download () {
  DEB_PATH=$1
  DEB_FILE=$(basename $DEB_PATH)
  curl -vf $UBUNTU_URL/pool/$DEB_PATH > $DEB_FILE
  dpkg-deb -X $DEB_FILE $BUILD_DIR/sw
}

mkdir $BUILD_DIR/sw

download main/r/ruby1.8/libruby1.8_1.8.7.249-2_amd64.deb
download main/r/ruby1.8/ruby1.8_1.8.7.249-2_amd64.deb
download main/r/ruby1.8/irb1.8_1.8.7.249-2_all.deb

#download main/u/util-linux/libuuid1_2.17.2-0ubuntu1.10.04.2_amd64.deb
#download main/u/util-linux/uuid-dev_2.17.2-0ubuntu1.10.04.2_amd64.deb

find $BUILD_DIR/sw -type l -ls

#rm $BUILD_DIR/sw/usr/lib/libuuid.so
#(
#  cd $BUILD_DIR/sw/usr/lib
#  ln -vnfs $BUILD_DIR/sw/lib/libuuid.so.1.3.0 libuuid.so
#)
